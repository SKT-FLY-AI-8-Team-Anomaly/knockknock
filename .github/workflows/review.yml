name: Assign Reviewers (All except author)

on:
  pull_request:
    types: [opened, reopened, ready_for_review]

jobs:
  assign-reviewers:
    runs-on: ubuntu-latest

    steps:
      - name: Assign reviewers (exclude author)
        env:
          GH_TOKEN: ${{ secrets.SHL0501TOKEN }}
        run: |
          author="${{ github.event.pull_request.user.login }}"
          pr_number="${{ github.event.pull_request.number }}"
          repo="${{ github.repository }}"

          reviewers=$(gh api repos/$repo/collaborators \
            --jq ".[] | select(.login != \"$author\") | .login")

          echo "Reviewers:"
          echo "$reviewers"

          for r in $reviewers; do
            gh pr edit "$pr_number" --repo "$repo" --add-reviewer "$r" || true
          done
